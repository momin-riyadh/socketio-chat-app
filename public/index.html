<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Socket.IO Chat</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="h-full bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-100 font-sans">
  <div class="min-h-full flex items-center justify-center p-4">
    <div class="w-full max-w-2xl rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl shadow-2xl overflow-hidden">
      <!-- Header -->
      <header class="px-6 py-4 bg-gradient-to-l from-pink-900 to-pink-900/50 border-b border-white/10">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center shadow-inner">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.97-4.03 9-9 9a8.962 8.962 0 0 1-4.5-1.2L3 21l1.2-4.5A8.962 8.962 0 0 1 3 12c0-4.97 4.03-9 9-9s9 4.03 9 9Z" />
              </svg>
            </div>
            <div>
              <h1 class="text-xl font-semibold tracking-tight">Socket.IO Chat</h1>
              <p class="text-xs text-slate-200/70">Real-time conversation, beautifully simple</p>
            </div>
          </div>
          <div class="text-xs text-white/70">Tailwind CSS</div>
        </div>
      </header>

      <!-- Chat body -->
      <div id="chat" class="flex flex-col h-[70vh] sm:h-[72vh] overflow-x-hidden">
        <!-- Messages list -->
        <ul id="messages" class="flex-1 overflow-y-auto overflow-x-hidden p-4 space-y-2 scroll-smooth">
          <!-- Messages will be appended here by script.js -->
        </ul>

        <!-- Typing indicator -->
        <div id="typing" class="px-4 pb-1 text-sm text-slate-300/80 h-6 select-none" aria-live="polite"></div>

        <!-- Composer -->
        <form id="form" action="" class="p-4 border-t border-white/10 bg-slate-900/40">
          <div class="flex items-end gap-2">
            <label class="inline-flex items-center justify-center h-12 w-12 rounded-xl bg-white/10 border border-white/10 hover:bg-white/15 active:bg-white/20 transition cursor-pointer" title="Attach files">
              <input id="fileInput" type="file" class="hidden" multiple />
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828L18 11.828a4 4 0 10-5.657-5.657L6.343 12.172"/></svg>
            </label>
            <input id="input" autocomplete="off" placeholder="Type your message..." class="flex-1 rounded-xl bg-white/10 border border-white/10 text-slate-100 placeholder:text-slate-300/60 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-500/60 focus:border-pink-400/50 transition" />
            <button id="send" class="inline-flex items-center gap-2 rounded-xl bg-pink-900 hover:bg-pink-600 active:bg-pink-700 text-white px-4 py-3 font-medium shadow-lg shadow-primary-900/30 transition">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m6 12 14-8-4 16-4-6-6-2z"/></svg>
              Send
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Socket.IO client script is required so that io() in script.js works.
       If you use a CDN or a bundler/ESM import, replace this with that source.
       For different origins, point to the server URL (e.g., http://localhost:3000/socket.io/socket.io.js). -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    // Optional: enhance message rendering with Tailwind-friendly markup while keeping IDs
    (function() {
      const origAppend = Element.prototype.appendChild;
      const messagesEl = document.getElementById('messages');
      // Monkey-patch only for our messages list to style li elements
      const observer = new MutationObserver((mutations) => {
        mutations.forEach(m => {
          m.addedNodes.forEach(node => {
            if (messagesEl.contains(node) && node.nodeName === 'LI') {
              // If this is a rich message (has its own inner bubble), only ensure row container basics
              if (node.getAttribute('data-msg') === 'true') {
                node.classList.add('max-w-[90%]','text-slate-100');
              } else {
                // Legacy/simple messages: style LI as the bubble
                node.classList.add('max-w-[80%]','px-3','py-2','rounded-lg','bg-white/10','backdrop-blur','border','border-white/10','text-slate-100','shadow');
              }
            }
          });
        });
      });
      observer.observe(messagesEl, { childList: true });
    })();
  </script>
  <script src="script.js"></script>
</body>
</html>
